$(function(){var e=location.host.substring(location.host.indexOf(".")+1),i=e.indexOf("beta")>=0?"beta.ulecdn.com":"ulecdn.com",t="app_ylxd";$.browser=$.browser||{},$.extend($.browser,function(){var e,i,t=navigator.userAgent.toLowerCase();if(t.indexOf("uleapp/")>0){if(i=t.sliceAfter("uleapp/").split("_")[3],e=t.sliceAfter("uleapp/").sliceBefore("_"),"ule"==t.sliceAfter("uleapp/").split("_")[1])var a={ule:!0,ylxd:!1};else var a={ule:!1,ylxd:!0};var s=$.extend({ios:"ios"==e,android:"android"==e,version:i},a);return s}return t.indexOf("ulxdapp/")>0?(e=t.sliceAfter("ulxdapp/").sliceBefore("_"),{ylxd:!0,wx:!1,ios:"ios"==e,android:"android"==e}):t.indexOf("uzgapp/")>0?(i=t.sliceAfter("uzgapp/").split("_")[3],e=t.sliceAfter("uzgapp/").sliceBefore("_"),{uzg:!0,wx:!1,ios:"ios"==e,android:"android"==e,version:i}):{ule:!1,uzg:!1,ylxd:!1,wx:t.match(/micromessenger/i),ios:t.match(/(iphone|ipod|ipad);?/i),android:t.match(/android/i)}}()),$.browser.uzg&&(t="app_uzg");var a={module:{itemKeys:["ulestore_temai_banner_s","ulestore_temai_grouplive","ulestore_temai_store"]},currStoreid:"",lid:"",client_type:"app_ylxd",viLink:"//m."+e+"/mxiaodian/item/preview/{0}.html?imageType=xl&client_type="+t+"&preview=1",api:{getShopUrl:"//static-content.ulecdn.com/mobilead/recommond/dwRecommond.do?restype=2001",getStoresUrl:"//static-content."+i+"/mobilead/recommond/dwRecommond.do?restype=2002",getNewCounpon:"https://mypurse."+e+"/uleWalletWeb/searchCoupons/searchCouponsFlag"},init:function(){var e=this;e.province=e.getCookie("ReferrerProvinceId")||e.getCookie("CurrentProvinceId"),e.getUserId(function(){e.getData(e.module.itemKeys.join(","),e.renderData),e.getBanners()}),e.bindEvent()},allData:{},getRequestN:1,getCookie:function(e){for(var i=document.cookie.split(";"),t=0,a=i.length;a>t;t++)if(i[t].split("=")[0].trim()==e)return i[t].split("=")[1]},getData:function(e,i){var t=this,a=t.api.getStoresUrl,s={sectionKeys:e};$.ajax({url:a,type:"get",data:s,dataType:"jsonp",jsonp:"callback",jsonpCallback:"callback",cache:!0,headers:{"Accept-Encoding":"gzip,deflate"},success:function(e){$.extend(t.allData,e),i&&i.call(t)},error:function(){alert("活动实在是太火爆了，排个队再来！")}})},bindEvent:function(){$("#keyWord").click(function(){$("#search_container").show().siblings(".main").hide(),$("#searchkeyWord").focus()}),$("#search_container .close").click(function(){$("#search_container").hide().siblings(".main").show()}),$("#search_btn").click(function(){var e=$("#searchkeyWord").val().trim();return""==e?(tipBox("请输入关键字"),!1):void(window.location.href=$.browser.ios?"objc:ulemobile://action&&US_GoodsSorcesVC&hasxib|0#levelClassified|0#searchName|"+encodeURI(e):"ulemobile://action&&ui.GoodsSourceActivity##fragment::1**levelClassified::0**searchName::"+encodeURI(e))})},getBanners:function(){var t=this,a=location.protocol+"//static-content."+i+"//mobilead/recommond/getMobileRecommond.do",s={sectionKeys:"ulestore_temai_banner_s",isAlone:"1"};$.ajax({url:a,type:"get",data:s,dataType:"jsonp",jsonp:"jsonApiCallback",jsonpCallback:"jsonApiCallback",cache:!0,headers:{"Accept-Encoding":"gzip,deflate"},success:function(i){if("0000"==i.returnCode)for(var a=i.ulestore_temai_banner_s.data||{},s="",l=0;l<a.length;l++){var o=a[l];if(o.province&&o.province.indexOf(t.province)>=0){var r="",n="",c="";if("1"==o.skipType)n=o.skipParam,r="ULEMOBILE://action&&ui.MyBusinessWebView##flag::1**load_url::"+n+"**title::"+o.title+"**needLogin::false**needTitle::true",$.browser.ios&&(r="objc:ulemobile://action&&WEBVIEW&hasxib|0#key|"+n+"#title|"+o.title+"#isShowTabbar|0#hasnavi|1"),c="activityLabel";else if("5"==o.skipType)n=o.skipParam,r="ULEMOBILE://action&&ui.MyBusinessWebView##flag::1**load_url::"+n+"**title::"+o.title+"**needLogin::false**needTitle::true**needShare::true",$.browser.ios&&(r="objc:ulemobile://action&&WEBVIEW&hasxib|0#key|"+n+"#title|"+o.title+"#isShowTabbar|0#hasnavi|1#needshare|1"),c="activityLabel";else if("4"==o.skipType)n=o.skipParam,r="ULEMOBILE://action&&ui.MyBusinessWebView##flag::1**load_url::"+n+"**title::"+o.title+"**needLogin::false**needTitle::false",$.browser.ios&&(r="objc:ulemobile://action&&WEBVIEW&hasxib|0#key|"+n+"#title|"+o.title+"#isShowTabbar|0#hasnavi|0"),c="activityLabel";else if("2"==o.skipType)n="https://m."+e+"/mxiaodian/item/preview/"+o.skipParam+".html?preview=9&imageType=xl",r="ULEMOBILE://action&&ui.MyBusinessWebView##flag::1**load_url::"+n+"**title::邮乐推荐**needLogin::false**needTitle::true",$.browser.ios&&(r="objc:ulemobile://action&&WEBVIEW&hasxib|0#key|"+n+"#isShowTabbar|0#hasnavi|1#title|邮乐推荐");else if("3"==o.skipType){var p="ULEMOBILE://action&&ui.DynamicGoodsActivity##fragment::1**flag::1**searchName::";r=p+o.skipParam+"**title::"+o.title,$.browser.ios&&(p="objc:ULEMOBILE://action&&US_DynamicGoodsVC&hasxib|0#searchName|",r=p+o.skipParam+"#title|"+o.title)}s+=' <li><a href="'+n+'"><img src="'+o.imgUrl+'" alt="" /></a></li>'}$("#hotData .bd ul").html(s),TouchSlide({slideCell:"#hotData",mainCell:".bd ul",effect:"leftLoop",titCell:".hd ul",autoPage:!0,autoPlay:!0})}}})},renderData:function(){var e=this;e.groupLive(),e.store(),e.tttj()},htmlTemp:function(){var e=[],i=[],t=[],a=[];return e.push("<li>"),e.push("<h3>{title}</h3>"),e.push('<p class="sec-title">{sec-title}</p>'),e.push('<div class="li-bottom">'),e.push('<a href="{link01}" ><img class="test-lazyload" src="//i0.ule.com/ulewap/i/290x290x2x.png"  data-original="{imgUrl}"></a>'),e.push('<a href="{link02}" ><img class="test-lazyload" src="//i0.ule.com/ulewap/i/290x290x2x.png"  data-original="{item02_pic}"></a>'),e.push("</div>"),e.push("</li>"),i.push('<li class="item" style="width:{_w}px;">'),i.push('<div class="product-pic" href="javascript:;">'),i.push('<div class="goodstore_top">'),i.push('<a href="javascript:;" module_id="{title}" class="logB">'),i.push('<span class="goodstore_loge"><img src="//pic2.ulecdn.com/item/user_0102/desc20171013/04b0884435de486f_-1x-1.jpg"></span>'),i.push('<p class="goodstore_title">'),i.push("</p><h4>{title}</h4>"),i.push("<p></p>"),i.push('<span class="goodstore_btn">点击进入</span>'),i.push("</a>"),i.push("</div>"),i.push('<ol class="goodstore_imglist">'),i.push("<li>"),i.push('<a href="{link01}">'),i.push('<p class="store-item-title">{item01_name}</p>'),i.push('<p class="store-item-price">￥<b>{item01_price}</b></p><img class="test-lazyload" src="//i0.ule.com/ulewap/i/290x290x2x.png"  data-original="{item01_pic}"></a>'),i.push("</li>"),i.push("<li>"),i.push('<a href="{link02}">'),i.push('<p class="store-item-title">{item02_name}</p>'),i.push('<p class="store-item-price">￥<b>{item02_price}</b></p><img class="test-lazyload" src="//i0.ule.com/ulewap/i/290x290x2x.png"  data-original="{item02_pic}"></a>'),i.push("</li>"),i.push("<li>"),i.push('<a href="{link03}">'),i.push('<p class="store-item-title">{item03_name}</p>'),i.push('<p class="store-item-price">￥<b>{item03_price}</b></p><img class="test-lazyload" src="//i0.ule.com/ulewap/i/290x290x2x.png"  data-original="{item03_pic}"></a>'),i.push("</li>"),i.push("</ol>"),i.push("</div>"),i.push("</li>"),t.push('<li class="">'),t.push('<a href="{link01}"><div class="li-left">'),t.push('<img class="test-lazyload" src="//i0.ule.com/ulewap/i/290x290x2x.png"  data-original="{defImgUrl}">'),t.push("</div>"),t.push('<div class="li-body">'),t.push("<h3>{listName}</h3>"),t.push('<p class="li-right-price">¥<b>{minPrice}</b></p>'),t.push('<p class="li-right-earn">赚:¥{commission}</p>'),t.push("</div></a>"),t.push("</li>"),a.push('<li class="">'),a.push('<a href="{link01}"><h3>{listName}</h3>'),a.push('<p class="li-right-price">¥<b>{minPrice}</b></p>'),a.push('<p class="li-right-earn">赚:¥{commission}</p>'),a.push('<div class="li-body">'),a.push('<a href="javascript:;"><img class="test-lazyload" src="//i0.ule.com/ulewap/i/290x290x2x.png"  data-original="{defImgUrl}"></a>'),a.push("</div></a>"),a.push("</li>"),{html1:e.join(""),html2:i.join(""),html3:t.join(""),html4:a.join("")}}(),tttj:function(){var e=this;$.getJSON("//static-content."+i+"/mobilead/recommond/dgRecommend.do?pageSize=3&pageIndex=1&orgProvince=58093&jsonApiCallback=?",function(i){for(var t="",a=i.data.recommendDaily||[],s=0;3>s;s++){var l=0==s?e.htmlTemp.html3:e.htmlTemp.html4;a[s].commission=(Math.round(100*a[s].commission)/100).toFixed(2),a[s].link01=e.viLink.format(a[s].listId)+"&storeid="+e.currStoreid,t+=l.substitute(a[s])}$(".recommend ol.rec-right").html(t)})},store:function(){var e=this,i=e.allData.ulestore_temai_store,t="",a=.9*$("body").width();$(".goodstore .bd ul").width(i.length*a);for(var s=0;s<i.length;s++)i[s]._w=a,$.extend(i[s],JSON.parse(i[s].customAttribute)),i[s].link01=e.viLink.format(i[s].item01_lid)+"&storeid="+e.currStoreid,i[s].link02=e.viLink.format(i[s].item02_lid)+"&storeid="+e.currStoreid,i[s].link03=e.viLink.format(i[s].item03_lid)+"&storeid="+e.currStoreid,t+=e.htmlTemp.html2.substitute(i[s]);$(".goodstore .bd ul").html(t),$(".test-lazyload").picLazyLoad({threshold:100,placeholder:"//i0.ule.com/ulewap/i/290x290x2x.png"})},groupLive:function(){for(var e=this,i=e.allData.ulestore_temai_grouplive,t="",a=0;a<i.length;a++)$.extend(i[a],JSON.parse(i[a].customAttribute)),i[a].link01=e.viLink.format(i[a].item01_lid)+"&storeid="+e.currStoreid,i[a].link02=e.viLink.format(i[a].item02_lid)+"&storeid="+e.currStoreid,t+=e.htmlTemp.html1.substitute(i[a]);$(".picgroup ol").html(t),$(".test-lazyload").picLazyLoad({threshold:100,placeholder:"//i0.ule.com/ulewap/i/290x290x2x.png"})},getUserId:function(i){var t=this;$.ajax({type:"get",async:!0,url:"//my."+e+"/usr/getIndexCookies.do",dataType:"jsonp",jsonp:"jsonCallBack",success:function(e){t.currStoreid=t.userId=e.useronlyid,i&&i.apply(t)},error:function(){alert("请求服务失败")}})}};a.init()});